category: Authentication
commonfields:
  id: Imperva WAF
  version: -1
configuration:
- defaultvalue: https://example.net
  display: Server URL (e.g. https://example.net)
  name: url
  required: true
  type: 0
- display: Username
  name: credentials
  required: true
  type: 9
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
display: Imperva WAF
name: Imperva WAF
script:
  commands:
  - deprecated: false
    execution: false
    name: imperva-waf-ip-group-list
    outputs:
    - contextPath: ImpervaWaf.IpGroup.Name
      type: String
  - arguments:
    - default: false
      isArray: false
      name: ip-group-name
      required: true
      secret: false
    deprecated: false
    execution: false
    name: imperva-waf-ip-group-list-entries
    outputs:
    - contextPath: ImpervaWaf.IpGroup.Entries.Type
      type: String
    - contextPath: ImpervaWaf.IpGroup.Entries.CidrMask
      type: Number
    - contextPath: ImpervaWaf.IpGroup.Entries.NetworkAddress
      type: String
    - contextPath: ImpervaWaf.IpGroup.Entries.IpAddressTo
      type: String
    - contextPath: ImpervaWaf.IpGroup.Entries.IpAddressFrom
      type: String
  - arguments:
    - default: false
      isArray: false
      name: ip-group-name
      required: true
      secret: false
    deprecated: false
    execution: false
    name: imperva-waf-ip-group-remove-entries
  - deprecated: false
    execution: false
    name: imperva-waf-sites-list
    outputs:
    - contextPath: ImpervaWaf.Site.Name
      type: String
  - arguments:
    - default: false
      isArray: false
      name: site-name
      required: true
      secret: false
    deprecated: false
    execution: false
    name: imperva-waf-server-group-list
    outputs:
    - contextPath: ImpervaWaf.ServerGroup.Name
      type: String
    - contextPath: ImpervaWaf.ServerGroup.SiteName
      type: String
  - arguments:
    - default: false
      isArray: false
      name: site-name
      required: true
      secret: false
    - default: false
      isArray: false
      name: server-group-name
      required: true
      secret: false
    deprecated: false
    execution: false
    name: imperva-waf-server-group-list-policies
    outputs:
    - contextPath: ImpervaWaf.SecurityPolicy.PolicyName
      type: String
    - contextPath: ImpervaWaf.SecurityPolicy.PolicyType
      type: String
    - contextPath: ImpervaWaf.SecurityPolicy.ServerGroup
      type: String
    - contextPath: ImpervaWaf.SecurityPolicy.SiteName
      type: String
    - contextPath: ImpervaWaf.SecurityPolicy.System
      type: Boolean
  - deprecated: false
    execution: false
    name: imperva-waf-web-service-custom-policy-list
    outputs:
    - contextPath: ImpervaWaf.CustomWebPolicy.Name
      type: String
  - arguments:
    - default: false
      isArray: false
      name: policy-name
      required: true
      secret: false
    deprecated: false
    execution: false
    name: imperva-waf-web-service-custom-policy-get
    outputs:
    - contextPath: ImpervaWaf.CustomWebPolicy.Enabled
      type: Boolean
    - contextPath: ImpervaWaf.CustomWebPolicy.FollowedAction
      type: String
    - contextPath: ImpervaWaf.CustomWebPolicy.Name
      type: String
    - contextPath: ImpervaWaf.CustomWebPolicy.OneAlertPerSession
      type: Boolean
    - contextPath: ImpervaWaf.CustomWebPolicy.DisplayResponsePage
      type: Boolean
    - contextPath: ImpervaWaf.CustomWebPolicy.Action
      type: String
    - contextPath: ImpervaWaf.CustomWebPolicy.Severity
      type: String
    - contextPath: ImpervaWaf.CustomWebPolicy.ApplyTo.serverGroupName
      type: String
    - contextPath: ImpervaWaf.CustomWebPolicy.ApplyTo.siteName
      type: String
    - contextPath: ImpervaWaf.CustomWebPolicy.ApplyTo.webServiceName
      type: String
    - contextPath: ImpervaWaf.CustomWebPolicy.MatchCriteria.operation
      type: String
    - contextPath: ImpervaWaf.CustomWebPolicy.MatchCriteria.type
      type: String
    - contextPath: ImpervaWaf.CustomWebPolicy.MatchCriteria
      type: Unknown
    - contextPath: ImpervaWaf.CustomWebPolicy.MatchCriteria.ipGroups.Group name
      type: String
    - contextPath: ImpervaWaf.CustomWebPolicy.MatchCriteria.userDefined.IP Address
      type: String
    - contextPath: ImpervaWaf.CustomWebPolicy.MatchCriteria.values.country
      type: String
  - arguments:
    - default: false
      isArray: false
      name: group-name
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      isArray: false
      name: entry-type
      predefined:
      - range
      - single
      - network
      required: true
      secret: false
    - default: false
      isArray: false
      name: ip-address-from
      required: false
      secret: false
    - default: false
      isArray: false
      name: ip-address-to
      required: false
      secret: false
    - default: false
      isArray: false
      name: network-address
      required: false
      secret: false
    - default: false
      isArray: false
      name: cidr-mask
      required: false
      secret: false
    - default: false
      isArray: false
      name: json-entries
      required: false
      secret: false
    deprecated: false
    execution: false
    name: imperva-waf-ip-group-create
    outputs:
    - contextPath: ImpervaWaf.IpGroup.Name
      type: String
  - arguments:
    - default: false
      isArray: false
      name: group-name
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      isArray: false
      name: entry-type
      predefined:
      - range
      - single
      - network
      required: true
      secret: false
    - default: false
      isArray: false
      name: ip-address-from
      required: false
      secret: false
    - default: false
      isArray: false
      name: ip-address-to
      required: false
      secret: false
    - default: false
      isArray: false
      name: network-address
      required: false
      secret: false
    - default: false
      isArray: false
      name: cidr-mask
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      isArray: false
      name: operation
      predefined:
      - add
      - remove
      required: true
      secret: false
    - default: false
      isArray: false
      name: json-entries
      required: false
      secret: false
    deprecated: false
    execution: false
    name: imperva-waf-ip-group-update-entries
  - arguments:
    - default: false
      isArray: false
      name: group-name
      required: true
      secret: false
    deprecated: false
    execution: false
    name: imperva-waf-ip-group-delete
  - arguments:
    - default: false
      isArray: false
      name: policy-name
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'True'
      isArray: false
      name: enabled
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: medium
      isArray: false
      name: severity
      predefined:
      - high
      - medium
      - low
      - informative
      - noAlert
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: none
      isArray: false
      name: action
      predefined:
      - block
      - none
      required: false
      secret: false
    - default: false
      isArray: false
      name: followed-action
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'False'
      isArray: false
      name: one-alert-per-session
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'False'
      isArray: false
      name: display-response-page
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    - default: false
      isArray: false
      name: site-name-to-apply
      required: true
      secret: false
    - default: false
      isArray: false
      name: server-group-name-to-apply
      required: true
      secret: false
    - default: false
      isArray: false
      name: web-service-name-to-apply
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      isArray: false
      name: geo-location-criteria-operation
      predefined:
      - atLeastOne
      - excludeAll
      required: false
      secret: false
    - default: false
      isArray: false
      name: ip-groups
      required: false
      secret: false
    - default: false
      isArray: false
      name: ip-addresses
      required: false
      secret: false
    - default: false
      isArray: false
      name: country-names
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      isArray: false
      name: ip-addresses-criteria-operation
      predefined:
      - atLeastOne
      - excludeAll
      required: false
      secret: false
    - default: false
      isArray: false
      name: match-criteria-json
      required: false
      secret: false
    deprecated: false
    execution: false
    name: imperva-waf-web-service-custom-policy-create
    outputs:
    - contextPath: ImpervaWaf.SecurityPolicy.Name
      type: String
  - arguments:
    - default: false
      isArray: false
      name: policy-name
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      isArray: false
      name: enabled
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: medium
      isArray: false
      name: severity
      predefined:
      - high
      - medium
      - low
      - informative
      - noAlert
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      isArray: false
      name: action
      predefined:
      - block
      - none
      required: false
      secret: false
    - default: false
      isArray: false
      name: followed-action
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      isArray: false
      name: one-alert-per-session
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      isArray: false
      name: display-response-page
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    - default: false
      isArray: false
      name: site-name-to-apply
      required: false
      secret: false
    - default: false
      isArray: false
      name: server-group-name-to-apply
      required: false
      secret: false
    - default: false
      isArray: false
      name: web-service-name-to-apply
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      isArray: false
      name: geo-location-criteria-operation
      predefined:
      - atLeastOne
      - excludeAll
      required: false
      secret: false
    - default: false
      isArray: false
      name: ip-groups
      required: false
      secret: false
    - default: false
      isArray: false
      name: ip-addresses
      required: false
      secret: false
    - default: false
      isArray: false
      name: country-names
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      isArray: false
      name: ip-addresses-criteria-operation
      predefined:
      - atLeastOne
      - excludeAll
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      isArray: false
      name: apply-operation
      predefined:
      - add
      - remove
      required: false
      secret: false
    - default: false
      isArray: false
      name: match-criteria-json
      required: false
      secret: false
    deprecated: false
    execution: false
    name: imperva-waf-web-service-custom-policy-update
  - arguments:
    - default: false
      isArray: false
      name: policy-name
      required: true
      secret: false
    deprecated: false
    execution: false
    name: imperva-waf-web-service-custom-policy-delete
  dockerimage: demisto/python3:3.7.4.2245
  feed: false
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
